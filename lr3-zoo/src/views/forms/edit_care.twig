<div id="editCareModal" class="modal">
  <div class="modal-content">
    <span class="close-care">&times;</span>
    <form id="editCareForm" method="POST" action="/cares/update">
      <input type="hidden" name="care_id" id="editCareId">
      <div class="form-group">
        <label for="editAnimalName">Название животного:</label>
        <input type="text" id="editAnimalName" name="animal_name" required>
      </div>
      <div class="form-group">
        <label for="editCareType">Тип ухода:</label>
        <input type="text" id="editCareType" name="care_type" required>
      </div>
      <button type="submit">Сохранить</button>
    </form>
  </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Открытие модального окна
  document.querySelectorAll('[id^="button_"]').forEach(button => {
    button.addEventListener('click', function() {
      const row = this.closest('tr');
      const careData = {
        id: this.id.split('_')[1],
        animal: row.cells[0].textContent,
        care: row.cells[1].textContent
      };

      document.getElementById('editCareId').value = careData.id;
      document.getElementById('editAnimalName').value = careData.animal;
      document.getElementById('editCareType').value = careData.care;
      
      document.getElementById('editCareModal').style.display = 'block';
    });
  });

  // Закрытие модального окна
  document.querySelector('.close-care').addEventListener('click', function() {
    document.getElementById('editCareModal').style.display = 'none';
  });

  window.addEventListener('click', function(event) {
    if (event.target === document.getElementById('editCareModal')) {
      document.getElementById('editCareModal').style.display = 'none';
    }
  });

  document.getElementById('editCareForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    fetch('/cares/update', {
      method: 'POST',
      body: new URLSearchParams(new FormData(this))
    })
    .then(response => {
      if (response.ok) {
        window.location.reload();
      } else {
        alert('Ошибка при сохранении');
      }
    })
    .catch(error => {
      console.error('Error:', error);
    });
  });
});
</script>